Atrial fibrillation (AF) is a common cardiac arrhythmia related to irregular atrial contractions. Several studies have shown that the analysis of P-waves extracted from ECG signals is helpful in understanding the predisposing factors to AF. However, P-waves are usually highly corrupted by noise and harmonic artifacts and this makes quite difficult their analysis. Recently we proposed a novel algorithm for denoising P-waves based on the notion of quadratic variation reduction. It is quite good in denoising P-waves affected by noise, but its effectiveness reduces when it is used in filtering out harmonic artifacts, like power-line interference. In this paper we propose an algorithm that overcomes this limitation and extends our previous method allowing it to both denoise and reject harmonic artifacts. Simulation results confirm the effectiveness of the approach and highlight its ability to remove both noise and artifacts. The algorithm has reduced computational complexity and this makes it suitable for real-time applications.