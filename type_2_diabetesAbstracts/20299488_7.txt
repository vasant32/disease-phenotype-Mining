 OBJECTIVE: Diabetes and heart failure commonly coexist, and prior studies have suggested better outcomes with metformin than other antidiabetic agents. We designed this study to determine whether this association reflects a beneficial effect of metformin or a harmful effect of other agents. RESEARCH DESIGN AND METHODS: We performed a case-control study nested within the U.K. General Practice Research Database cohort in which diagnoses were assigned by each patient's primary care physician. Case subjects were patients 35 years or older, newly diagnosed with both heart failure and diabetes after January 1988, and who died prior to October 2007. Control subjects were matched to case subjects based on age, sex, clinic site, calendar year, and duration of follow-up. Analyses were adjusted for comorbidities, A1C, renal function, and BMI. RESULTS: The duration of concurrent diabetes and heart failure was 2.8 years (SD 2.6) in our 1,633 case subjects and 1,633 control subjects (mean age 78 years, 53% male). Compared with patients who were not exposed to antidiabetic drugs, the current use of metformin monotherapy (adjusted odds ratio 0.65 [0.48-0.87]) or metformin with or without other agents (0.72 [0.59-0.90]) was associated with lower mortality; however, use of other antidiabetic drugs or insulin was not associated with all-cause mortality. Conversely, the use of ACE inhibitors/angiotensin receptor blockers (0.55 [0.45-0.68]) and beta-blockers (0.76 [0.61-0.95]) were associated with reduced mortality. CONCLUSIONS: Our results confirm the benefits of trial-proven anti-failure therapies in patients with diabetes and support the use of metformin-based strategies to lower glucose.